# ãƒ¡ãƒ¼ãƒ«é€šçŸ¥ã‚·ã‚¹ãƒ†ãƒ  - ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰

**ä½œæˆæ—¥**: 2025å¹´11æœˆ10æ—¥
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.0.0

---

## ğŸ“§ æ¦‚è¦

ã“ã®ã‚·ã‚¹ãƒ†ãƒ ã«ã¯ã€Resendã‚’ä½¿ç”¨ã—ãŸãƒ¡ãƒ¼ãƒ«é€šçŸ¥æ©Ÿèƒ½ãŒå®Œå…¨ã«å®Ÿè£…ã•ã‚Œã¦ã„ã¾ã™ã€‚

### å®Ÿè£…æ¸ˆã¿ã®æ©Ÿèƒ½

âœ… **AIãƒ¬ãƒãƒ¼ãƒˆå®Œæˆé€šçŸ¥ãƒ¡ãƒ¼ãƒ«**
- ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆå®Œäº†æ™‚ã«è‡ªå‹•é€ä¿¡
- ä¸»è¦KPIã‚’HTMLå½¢å¼ã§è¡¨ç¤º
- ãƒ¬ãƒãƒ¼ãƒˆè©³ç´°ãƒšãƒ¼ã‚¸ã¸ã®ãƒªãƒ³ã‚¯ä»˜ã

âœ… **ãƒ¡ãƒ³ãƒãƒ¼æ‹›å¾…ãƒ¡ãƒ¼ãƒ«**
- æ–°è¦ãƒ¡ãƒ³ãƒãƒ¼æ‹›å¾…æ™‚ã«è‡ªå‹•é€ä¿¡
- ç¾ã—ã„HTMLãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
- ãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯ã§å‚åŠ å¯èƒ½

âœ… **ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒªã‚»ãƒƒãƒˆãƒ¡ãƒ¼ãƒ«**
- Supabase Authã®æ¨™æº–æ©Ÿèƒ½ã‚’ä½¿ç”¨

âœ… **å†…éƒ¨é€šçŸ¥ã‚·ã‚¹ãƒ†ãƒ **
- AIä½¿ç”¨é‡ã‚¢ãƒ©ãƒ¼ãƒˆ
- ãƒˆãƒ©ã‚¤ã‚¢ãƒ«æœŸé™é€šçŸ¥
- ç›®æ¨™é”æˆé€šçŸ¥
- æ–°ãƒ¡ãƒ³ãƒãƒ¼è¿½åŠ é€šçŸ¥
- ãã®ä»–10ç¨®é¡ä»¥ä¸Šã®é€šçŸ¥ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ

---

## ğŸš€ ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †

### ã‚¹ãƒ†ãƒƒãƒ—1: Resendã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ä½œæˆ

1. [Resend](https://resend.com/)ã«ã‚¢ã‚¯ã‚»ã‚¹
2. ã€ŒSign Upã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ç„¡æ–™ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½œæˆ
3. ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ç¢ºèª

**ç„¡æ–™ãƒ—ãƒ©ãƒ³**:
- æœˆé–“3,000é€šã¾ã§ç„¡æ–™
- é–‹ç™ºãƒ»ãƒ†ã‚¹ãƒˆç”¨é€”ã«æœ€é©

### ã‚¹ãƒ†ãƒƒãƒ—2: APIã‚­ãƒ¼ã®å–å¾—

1. Resendãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«ãƒ­ã‚°ã‚¤ãƒ³
2. å·¦ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰ã€ŒAPI Keysã€ã‚’ã‚¯ãƒªãƒƒã‚¯
3. ã€ŒCreate API Keyã€ã‚’ã‚¯ãƒªãƒƒã‚¯
4. åå‰ã‚’å…¥åŠ›ï¼ˆä¾‹: `Production API Key`ï¼‰
5. ã€ŒFull Accessã€ã‚’é¸æŠ
6. APIã‚­ãƒ¼ã‚’ã‚³ãƒ”ãƒ¼ï¼ˆä¸€åº¦ã—ã‹è¡¨ç¤ºã•ã‚Œã¾ã›ã‚“ï¼‰

**APIã‚­ãƒ¼ã®å½¢å¼**: `re_xxxxxxxxxxxxxxxxxxxxxxxxxx`

### ã‚¹ãƒ†ãƒƒãƒ—3: ãƒ‰ãƒ¡ã‚¤ãƒ³ã®è¨­å®šï¼ˆæœ¬ç•ªç’°å¢ƒã®ã¿ï¼‰

é–‹ç™ºç’°å¢ƒã§ã¯ã€Resendã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ‰ãƒ¡ã‚¤ãƒ³ã§ãƒ¡ãƒ¼ãƒ«Bé€ä¿¡ã§ãã¾ã™ã€‚

**æœ¬ç•ªç’°å¢ƒã§ã¯ç‹¬è‡ªãƒ‰ãƒ¡ã‚¤ãƒ³ã®è¨­å®šãŒå¿…è¦ã§ã™**:

1. Resendãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§ã€ŒDomainsã€ã‚’é¸æŠ
2. ã€ŒAdd Domainã€ã‚’ã‚¯ãƒªãƒƒã‚¯
3. ä½¿ç”¨ã™ã‚‹ãƒ‰ãƒ¡ã‚¤ãƒ³åã‚’å…¥åŠ›ï¼ˆä¾‹: `yourdomain.com`ï¼‰
4. è¡¨ç¤ºã•ã‚Œã‚‹DNSãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’ãƒ‰ãƒ¡ã‚¤ãƒ³ç®¡ç†ç”»é¢ã«è¿½åŠ :
   ```
   ã‚¿ã‚¤ãƒ—: TXT
   åå‰: _resend
   å€¤: <ResendãŒæä¾›ã™ã‚‹å€¤>

   ã‚¿ã‚¤ãƒ—: MX
   åå‰: @
   å€¤: feedback-smtp.resend.com (å„ªå…ˆåº¦: 10)
   ```
5. DNSä¼æ’­ã‚’å¾…ã¤ï¼ˆæœ€å¤§48æ™‚é–“ã€é€šå¸¸ã¯æ•°åˆ†ï¼‰
6. ã€ŒVerify Domainã€ã‚’ã‚¯ãƒªãƒƒã‚¯

### ã‚¹ãƒ†ãƒƒãƒ—4: Supabaseç’°å¢ƒå¤‰æ•°ã®è¨­å®š

#### æ–¹æ³•1: Supabase Dashboardã‹ã‚‰è¨­å®šï¼ˆæ¨å¥¨ï¼‰

1. [Supabase Dashboard](https://supabase.com/dashboard)ã«ãƒ­ã‚°ã‚¤ãƒ³
2. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’é¸æŠ
3. å·¦ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰ã€ŒProject Settingsã€â†’ã€ŒEdge Functionsã€ã‚’é¸æŠ
4. ã€ŒAdd Secretã€ã‚’ã‚¯ãƒªãƒƒã‚¯
5. ä»¥ä¸‹ã‚’è¿½åŠ :
   ```
   Name: RESEND_API_KEY
   Value: re_xxxxxxxxxxxxxxxxxxxxxxxxxx
   ```
6. ã€ŒSaveã€ã‚’ã‚¯ãƒªãƒƒã‚¯

#### æ–¹æ³•2: Supabase CLIã‹ã‚‰è¨­å®š

```bash
# Supabase CLIã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼ˆæœªã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã®å ´åˆï¼‰
npm install -g supabase

# ãƒ­ã‚°ã‚¤ãƒ³
supabase login

# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ãƒªãƒ³ã‚¯
supabase link --project-ref your-project-ref

# ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã‚’è¨­å®š
supabase secrets set RESEND_API_KEY=re_xxxxxxxxxxxxxxxxxxxxxxxxxx
```

### ã‚¹ãƒ†ãƒƒãƒ—5: Edge Functionsã®ãƒ‡ãƒ—ãƒ­ã‚¤

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ã¯2ã¤ã®ãƒ¡ãƒ¼ãƒ«é€ä¿¡ç”¨Edge FunctionsãŒã‚ã‚Šã¾ã™:

#### 1. send-report-email
AIãƒ¬ãƒãƒ¼ãƒˆå®Œæˆé€šçŸ¥ç”¨

#### 2. send-invitation-email
ãƒ¡ãƒ³ãƒãƒ¼æ‹›å¾…ç”¨

**ãƒ‡ãƒ—ãƒ­ã‚¤ã‚³ãƒãƒ³ãƒ‰**:
```bash
# 1ã¤ãšã¤ãƒ‡ãƒ—ãƒ­ã‚¤
supabase functions deploy send-report-email
supabase functions deploy send-invitation-email

# ã¾ãŸã¯ä¸€æ‹¬ãƒ‡ãƒ—ãƒ­ã‚¤
supabase functions deploy
```

### ã‚¹ãƒ†ãƒƒãƒ—6: é€ä¿¡å…ƒãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã®è¨­å®š

Edge Functionå†…ã®é€ä¿¡å…ƒã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å¤‰æ›´ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™:

#### send-report-email/index.ts
```typescript
// 133è¡Œç›®ä»˜è¿‘
from: 'ãƒ¬ãƒãƒ¼ãƒˆé…ä¿¡ <reports@updates.yourdomain.com>',
```

#### send-invitation-email/index.ts
```typescript
// 185è¡Œç›®ä»˜è¿‘
from: 'AI Management System <noreply@yourdomain.com>',
```

**å¤‰æ›´å¾Œã€å†ãƒ‡ãƒ—ãƒ­ã‚¤ãŒå¿…è¦ã§ã™**:
```bash
supabase functions deploy send-report-email
supabase functions deploy send-invitation-email
```

---

## ğŸ§ª ãƒ†ã‚¹ãƒˆæ–¹æ³•

### 1. ãƒ‡ãƒ¢ãƒ¢ãƒ¼ãƒ‰ã§ã®ãƒ†ã‚¹ãƒˆ

APIã‚­ãƒ¼ã‚’è¨­å®šã—ãªã„å ´åˆã€è‡ªå‹•çš„ã«ãƒ‡ãƒ¢ãƒ¢ãƒ¼ãƒ‰ã§å‹•ä½œã—ã¾ã™:
- ãƒ¡ãƒ¼ãƒ«ã¯é€ä¿¡ã•ã‚Œã¾ã›ã‚“ãŒã€å‡¦ç†ã¯æ­£å¸¸ã«å®Œäº†ã—ã¾ã™
- ãƒ­ã‚°ã«è©³ç´°æƒ…å ±ãŒå‡ºåŠ›ã•ã‚Œã¾ã™

### 2. Resend Test Mode

Resendã®ãƒ†ã‚¹ãƒˆãƒ¢ãƒ¼ãƒ‰ã‚’ä½¿ç”¨:
```typescript
// Edge Functionã§
const resendResponse = await fetch('https://api.resend.com/emails', {
  headers: {
    'Authorization': `Bearer ${resendApiKey}`,
    'X-Entity-Ref-ID': 'test-mode', // ãƒ†ã‚¹ãƒˆãƒ¢ãƒ¼ãƒ‰
  }
})
```

### 3. å®Ÿéš›ã®ãƒ¡ãƒ¼ãƒ«é€ä¿¡ãƒ†ã‚¹ãƒˆ

1. çµ„ç¹”ã«ãƒ¡ãƒ³ãƒãƒ¼ã‚’æ‹›å¾…ã™ã‚‹
2. Resendãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§ã€ŒEmailsã€ã‚’ç¢ºèª
3. é€ä¿¡ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’ç¢ºèª:
   - âœ… Delivered: é…ä¿¡æˆåŠŸ
   - â³ Sending: é€ä¿¡ä¸­
   - âŒ Failed: å¤±æ•—ï¼ˆã‚¨ãƒ©ãƒ¼å†…å®¹ã‚’ç¢ºèªï¼‰

---

## ğŸ“Š ä½¿ç”¨æ–¹æ³•

### AIãƒ¬ãƒãƒ¼ãƒˆå®Œæˆé€šçŸ¥ã®é€ä¿¡

```typescript
import { sendReportEmail } from '@/services/emailService'

// ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆå¾Œ
const result = await sendReportEmail({
  reportId: 'report-uuid',
  recipientEmail: 'user@example.com'
})

if (result.success) {
  console.log('ãƒ¡ãƒ¼ãƒ«é€ä¿¡æˆåŠŸ:', result.messageId)
} else {
  console.error('ãƒ¡ãƒ¼ãƒ«é€ä¿¡å¤±æ•—:', result.error)
}
```

### ãƒ¡ãƒ³ãƒãƒ¼æ‹›å¾…ãƒ¡ãƒ¼ãƒ«ã®é€ä¿¡

```typescript
import { sendInvitationEmail } from '@/services/emailService'

// æ‹›å¾…ä½œæˆæ™‚ï¼ˆè‡ªå‹•çš„ã«é€ä¿¡ã•ã‚Œã¾ã™ï¼‰
const invitation = await createInvitation(
  organizationId,
  'newmember@example.com',
  'manager',
  currentUserId
)
// â†‘ å†…éƒ¨ã§sendInvitationEmailãŒè‡ªå‹•çš„ã«å‘¼ã°ã‚Œã¾ã™
```

### å†…éƒ¨é€šçŸ¥ã®ä½œæˆ

```typescript
import { notificationService, NotificationTemplates } from '@/services/notificationService'

// AIä½¿ç”¨é‡ã‚¢ãƒ©ãƒ¼ãƒˆ
const template = NotificationTemplates.aiUsageThresholdReached(85, 850, 1000)
await notificationService.create({
  userId: user.id,
  organizationId: org.id,
  ...template
})

// ç›®æ¨™é”æˆé€šçŸ¥
const goalTemplate = NotificationTemplates.goalAchievement(
  'æ–°å®¿åº—',
  105,
  1000000,
  1050000
)
await notificationService.create({
  userId: manager.id,
  organizationId: org.id,
  ...goalTemplate
})
```

---

## ğŸ¨ ãƒ¡ãƒ¼ãƒ«ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º

### ãƒ¬ãƒãƒ¼ãƒˆãƒ¡ãƒ¼ãƒ«ã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º

`supabase/functions/send-report-email/index.ts`ã®84ã€œ180è¡Œç›®:

```typescript
const emailHtml = `
<!DOCTYPE html>
<html>
<head>
  <!-- ã“ã“ã§ã‚¹ã‚¿ã‚¤ãƒ«ã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º -->
  <style>
    .header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
    /* è‰²ã‚„ãƒ•ã‚©ãƒ³ãƒˆã‚’å¤‰æ›´ */
  </style>
</head>
<body>
  <!-- HTMLã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
</body>
</html>
`;
```

### æ‹›å¾…ãƒ¡ãƒ¼ãƒ«ã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º

`supabase/functions/send-invitation-email/index.ts`ã®68ã€œ164è¡Œç›®:

```typescript
const emailHtml = `
<!DOCTYPE html>
<html>
  <!-- ãƒ­ã‚´ã€è‰²ã€æ–‡è¨€ã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º -->
</html>
`;
```

**å¤‰æ›´å¾Œã¯å¿…ãšå†ãƒ‡ãƒ—ãƒ­ã‚¤**:
```bash
supabase functions deploy send-report-email
supabase functions deploy send-invitation-email
```

---

## ğŸ”§ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ãƒ¡ãƒ¼ãƒ«ãŒå±Šã‹ãªã„

**1. Resend Dashboardã‚’ç¢ºèª**
- ã€ŒEmailsã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§é€ä¿¡ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’ç¢ºèª
- ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç¢ºèª

**2. APIã‚­ãƒ¼ã‚’ç¢ºèª**
```bash
supabase secrets list | grep RESEND_API_KEY
```

**3. Edge Functionã®ãƒ­ã‚°ã‚’ç¢ºèª**
```bash
supabase functions logs send-report-email
supabase functions logs send-invitation-email
```

**4. ãƒ‰ãƒ¡ã‚¤ãƒ³æ¤œè¨¼ã‚’ç¢ºèª**
- Resendãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§Domain statusãŒã€ŒVerifiedã€ã‹ç¢ºèª

### ã‚ˆãã‚ã‚‹ã‚¨ãƒ©ãƒ¼

#### Error: "API key is invalid"
â†’ APIã‚­ãƒ¼ãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ãªã„
```bash
supabase secrets set RESEND_API_KEY=re_correct_key_here
```

#### Error: "Domain not verified"
â†’ ãƒ‰ãƒ¡ã‚¤ãƒ³ã®DNSè¨­å®šãŒå®Œäº†ã—ã¦ã„ãªã„
â†’ Resendãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§è¨­å®šã‚’ç¢ºèª

#### Error: "Rate limit exceeded"
â†’ é€ä¿¡åˆ¶é™ã«é”ã—ãŸ
â†’ Resendãƒ—ãƒ©ãƒ³ã‚’ç¢ºèªï¼ˆç„¡æ–™ãƒ—ãƒ©ãƒ³: 3,000é€š/æœˆï¼‰

#### Error: "Invalid from address"
â†’ é€ä¿¡å…ƒã‚¢ãƒ‰ãƒ¬ã‚¹ãŒæœªæ¤œè¨¼
â†’ Resendã§ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’æ¤œè¨¼ã™ã‚‹ã‹ã€`onboarding@resend.dev`ã‚’ä½¿ç”¨

---

## ğŸ’° æ–™é‡‘ãƒ—ãƒ©ãƒ³

### Resendæ–™é‡‘

| ãƒ—ãƒ©ãƒ³ | æœˆé¡ | é€ä¿¡æ•° | ç‰¹å¾´ |
|--------|------|--------|------|
| **Free** | $0 | 3,000é€š | é–‹ç™ºãƒ»ãƒ†ã‚¹ãƒˆç”¨ |
| **Pro** | $20 | 50,000é€š | æœ¬ç•ªç’°å¢ƒæ¨å¥¨ |
| **Enterprise** | ã‚«ã‚¹ã‚¿ãƒ  | ç„¡åˆ¶é™ | å¤§è¦æ¨¡åˆ©ç”¨ |

**å¾“é‡èª²é‡‘**: ä¸Šé™ã‚’è¶…ãˆãŸå ´åˆã€1,000é€šã”ã¨ã«$1

### ä½¿ç”¨é‡ã®ç›®å®‰

**æƒ³å®šã‚·ãƒŠãƒªã‚ª**ï¼ˆæœˆé–“ï¼‰:
- çµ„ç¹”æ•°: 100
- ãƒ¦ãƒ¼ã‚¶ãƒ¼æ•°: 500
- ãƒ¡ãƒ¼ãƒ«ç¨®åˆ¥:
  - æ‹›å¾…ãƒ¡ãƒ¼ãƒ«: 50é€š
  - ãƒ¬ãƒãƒ¼ãƒˆé€šçŸ¥: 400é€šï¼ˆé€±æ¬¡ãƒ¬ãƒãƒ¼ãƒˆ Ã— 4é€± Ã— 100çµ„ç¹”ï¼‰
  - ãã®ä»–é€šçŸ¥: 100é€š

**åˆè¨ˆ**: ç´„550é€š/æœˆ â†’ **ç„¡æ–™ãƒ—ãƒ©ãƒ³ã§ååˆ†**

---

## ğŸ” ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

### 1. APIã‚­ãƒ¼ã®ç®¡ç†

âŒ **çµ¶å¯¾ã«ã—ãªã„ã“ã¨**:
```typescript
// ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã§ç›´æ¥APIã‚­ãƒ¼ã‚’ä½¿ç”¨
const RESEND_API_KEY = 're_xxxxxxxxxxxx' // NG!
```

âœ… **æ­£ã—ã„æ–¹æ³•**:
- Edge Functionsã§ã®ã¿ä½¿ç”¨
- Supabase Secretsã«ä¿å­˜
- ç’°å¢ƒå¤‰æ•°ã¨ã—ã¦ç®¡ç†

### 2. ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã®æ¤œè¨¼

```typescript
// ãƒ¡ãƒ¼ãƒ«é€ä¿¡å‰ã«ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/
if (!emailRegex.test(email)) {
  throw new Error('ç„¡åŠ¹ãªãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹')
}
```

### 3. ãƒ¬ãƒ¼ãƒˆåˆ¶é™

```typescript
// 1ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚ãŸã‚Šã®é€ä¿¡åˆ¶é™ã‚’å®Ÿè£…
const MAX_EMAILS_PER_HOUR = 10

// Supabaseã®rate_limitãƒ†ãƒ¼ãƒ–ãƒ«ã§ç®¡ç†
```

---

## ğŸ“ˆ ç›£è¦–ã¨ãƒ­ã‚°

### é€ä¿¡æˆåŠŸç‡ã®ç›£è¦–

```typescript
// Edge Functionã§
console.log('Email sent successfully:', {
  messageId: result.id,
  recipient: recipientEmail,
  timestamp: new Date().toISOString()
})
```

### Resend Analyticsã®æ´»ç”¨

Resendãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§ä»¥ä¸‹ã‚’ç¢ºèª:
- é€ä¿¡æ•°
- é…ä¿¡ç‡
- ãƒã‚¦ãƒ³ã‚¹ç‡
- ã‚¯ãƒªãƒƒã‚¯ç‡ï¼ˆãƒªãƒ³ã‚¯ãŒã‚ã‚‹å ´åˆï¼‰

---

## ğŸ¯ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

### è¿½åŠ å®Ÿè£…æ¨å¥¨æ©Ÿèƒ½

1. **å®šæœŸãƒ¬ãƒãƒ¼ãƒˆã®è‡ªå‹•é…ä¿¡**
   ```bash
   # Supabase Cron Job
   SELECT cron.schedule(
     'weekly-reports',
     '0 9 * * 1',  -- æ¯é€±æœˆæ›œ 9:00
     $$ SELECT net.http_post(...) $$
   );
   ```

2. **ãƒ¡ãƒ¼ãƒ«é€ä¿¡å±¥æ­´ãƒ†ãƒ¼ãƒ–ãƒ«**
   ```sql
   CREATE TABLE email_logs (
     id uuid PRIMARY KEY,
     email_type text,
     recipient text,
     sent_at timestamptz,
     status text,
     message_id text
   );
   ```

3. **ãƒ¡ãƒ¼ãƒ«è¨­å®šãƒšãƒ¼ã‚¸**
   - ãƒ¦ãƒ¼ã‚¶ãƒ¼ã”ã¨ã®é€šçŸ¥è¨­å®š
   - ãƒ¡ãƒ¼ãƒ«å—ä¿¡ã®ã‚ªãƒ³/ã‚ªãƒ•
   - é€ä¿¡é »åº¦ã®è¨­å®š

4. **HTMLãƒ¡ãƒ¼ãƒ«ã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æ©Ÿèƒ½**
   - é€ä¿¡å‰ã«ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼
   - ãƒ†ã‚¹ãƒˆãƒ¡ãƒ¼ãƒ«ã®é€ä¿¡

---

## ğŸ“š å‚è€ƒãƒªãƒ³ã‚¯

- [Resendå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://resend.com/docs)
- [Supabase Edge Functions](https://supabase.com/docs/guides/functions)
- [ãƒ¡ãƒ¼ãƒ«HTMLä½œæˆã‚¬ã‚¤ãƒ‰](https://www.caniemail.com/)

---

## âœ… ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### é–‹ç™ºç’°å¢ƒ
- [ ] Resendã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆ
- [ ] APIã‚­ãƒ¼å–å¾—
- [ ] Supabase Secretsã«è¨­å®š
- [ ] Edge Functionsãƒ‡ãƒ—ãƒ­ã‚¤
- [ ] ãƒ†ã‚¹ãƒˆãƒ¡ãƒ¼ãƒ«é€ä¿¡æˆåŠŸ

### æœ¬ç•ªç’°å¢ƒ
- [ ] ç‹¬è‡ªãƒ‰ãƒ¡ã‚¤ãƒ³ã®è¨­å®š
- [ ] DNSè¨­å®šå®Œäº†
- [ ] ãƒ‰ãƒ¡ã‚¤ãƒ³æ¤œè¨¼å®Œäº†
- [ ] é€ä¿¡å…ƒã‚¢ãƒ‰ãƒ¬ã‚¹ã®å¤‰æ›´
- [ ] Edge Functionså†ãƒ‡ãƒ—ãƒ­ã‚¤
- [ ] æœ¬ç•ªç’°å¢ƒã§ãƒ†ã‚¹ãƒˆé€ä¿¡
- [ ] ç›£è¦–ã¨ã‚¢ãƒ©ãƒ¼ãƒˆã®è¨­å®š

---

**è¨­å®šå®Œäº†å¾Œã€ãƒ¡ãƒ¼ãƒ«é€šçŸ¥ã‚·ã‚¹ãƒ†ãƒ ãŒå®Œå…¨ã«æ©Ÿèƒ½ã—ã¾ã™ï¼** ğŸ‰
